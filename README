###################################
# 検索エンジン基盤 TSUBAKI README #
###################################

2012/04/27 Daisuke Kawahara <dk@i.kyoto-u.ac.jp>


TSUBAKIは、科研特定領域研究「情報爆発」(2006年度〜2010年度)において、京
都大学黒橋・河原研究室にて開発した検索エンジン基盤です。その特徴は、構
文・格解析、同義語・句のマッチングなど深い言語解析技術に基づく検索です。
1CPUあたり100万文書程度の検索が可能で、複数CPUの並列化により大規模文書
集合の検索に対応しています。また、言語としては、日本語と英語に対応して
います。

TSUBAKIで検索を行うには、検索対象文書に対して次の2ステップの処理を行う
必要があります。

  1. 検索対象文書に言語解析を適用し、その解析結果をXML形式で出力
     (以後、このXML形式を「TSUBAKI標準フォーマット」と呼びます。)
  2. 標準フォーマットデータからインデックスを生成

以下では、準備、TSUBAKI標準フォーマット変換(上記1)、インデックス生成(上
記2)、検索の順番に説明します。


====
準備
====

* 必要なツール、ライブラリなどのインストール

- 必要なライブラリのインストール
  -- libxml (http://xmlsoft.org/)
  -- TinyCDB (http://www.corpit.ru/mjt/tinycdb.html)


- 必要なPerlモジュールのインストール (CPANからダウンロード、インストール)
  -- Unicode::Japanese
  -- PerlIO::gzip
  -- XML::LibXML
  -- CDB_File
  -- Error (Module::Metadata, version, Perl::OSType, Module::Buildも必要)


- 日本語の文書を検索する場合
  -- 日本語形態素解析システムJUMAN,のダウンロード、インストール
     http://nlp.ist.i.kyoto-u.ac.jp/index.php?JUMAN

  -- 日本語構文・格解析システムKNPのダウンロード、インストール
     http://nlp.ist.i.kyoto-u.ac.jp/index.php?KNP

  -- SynGraph日本語データベース(同義語・句の辞書)のダウンロード
     http://... を取得し、TSUBAKI直下(このディレクトリ)にて展開してください。


- 英語の文書を検索する場合
  -- Enju - A fast, accurate, and deep parser for Englishのダウンロード、インストール
     http://www.nactem.ac.uk/enju/index.ja.html

  ※ SynGraph英語データベースは未リリースです。英語の同義語・句のデータ
     を別途用意すれば、SynGraphデータベース形式に変換して使うことができ
     ます。詳細は、SynGraphのドキュメントをご覧ください。


====================
標準フォーマット生成
====================





================
インデックス生成
================

TSUBAKI/sf2index/sample_data_{ja, en}にある、日本語・英語のサンプル標準
フォーマットデータを対象にして説明します。サンプル以外の標準フォーマッ
トを用いる場合に設定が必要な箇所にはその旨を記述しています。

* 1. 設定

  TSUBAKI直下(このディレクトリ)において、./setup.sh を実行

  ※ 英語の文書を検索する場合は、"-e"を付加
  ※ サンプル標準フォーマット以外を対象にする場合は、"-d 標準フォーマットデータパス"によって指定


* 2. インデックス生成

  TSUBAKI直下(このディレクトリ)において、makeを実行

  ※ TSUBAKI/searchでコンパイルが失敗する場合は、TSUBAKI/search/Makefileにおいて、
     CXXFLAGSとCDB_LIBをcdb.h、libcdb.aのインストール場所に応じて修正する


====
検索
====

* 1. 検索テスト

- TSUBAKI/sf2index下で "./search.sh クエリ"を実行して検索 (日本語のクエリはUTF8で入力)

   日本語の検索例) ./search.sh 旅館	→ hitcountが2になる
                   ./search.sh 駅	→ hitcountが1になる


* 2. ブラウザからの検索

- 検索サーバとスニペットサーバの起動
  TSUBAKI/scripts/server-all.sh start

  -- 止める場合は次のとおり
     TSUBAKI/scripts/server-all.sh stop

- TSUBAKI/cgi/index.cgiをブラウザでたたいて検索


============
ドキュメント
============

より詳細なドキュメントは、TSUBAKI Wikiを参照してください。
  http://tsubaki-wiki.ixnlp.nii.ac.jp/index.php
    username: tsubaki-user
    password: tsu8k!
